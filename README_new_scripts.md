# 新截图脚本使用说明

## 概述

根据您原来的项目逻辑，我创建了两个新的脚本，专门用于新的URL：`http://177.11.176.11:23343/yitu/#/chart/publishShort/4ujd3lwbaow000`

这些脚本**不进行相似度比对**，直接截图然后发送到钉钉群，钉钉发送的robot_id已改为**2206**。

## 脚本文件

### 1. `simple_screenshot.py` (推荐使用)
- **简化版本**，不依赖配置文件
- 直接在脚本中配置参数
- 专门用于单个URL的截图
- 更容易理解和修改

### 2. `new_screenshot_script.py`
- 完整版本，使用配置文件
- 支持多个目标配置
- 与原来脚本结构更相似

### 3. `config.new.yaml`
- 新脚本的配置文件
- 包含新URL的配置信息

## 使用方法

### 方法1：使用简化版脚本（推荐）

```bash
python simple_screenshot.py
```

### 方法2：使用完整版脚本

```bash
python new_screenshot_script.py
```

## 主要特点

1. **不进行相似度比对** - 移除了原来的图片比较逻辑
2. **钉钉群ID改为2206** - 符合您的新要求
3. **保持原有逻辑** - 截图、保存、发送到钉钉群的功能完全保留
4. **支持iframe截图** - 自动检测并截取iframe区域
5. **错误重试机制** - 网络请求失败时自动重试
6. **本地保存** - 截图会保存到 `.history` 目录中

## 配置参数

在 `simple_screenshot.py` 中，您可以修改以下参数：

```python
TARGET_URL = "http://177.11.176.11:23343/yitu/#/chart/publishShort/4ujd3lwbaow000"
TARGET_NAME = "new_chart"
DINGDING_ROBOT_ID = "2206"
WAIT_TIME = 60  # 等待页面加载的时间（秒）
AFTER_LOAD_WAIT = 10  # 加载后的额外等待时间（秒）
```

## 输出说明

脚本执行后会：

1. 访问指定URL
2. 等待页面加载完成
3. 尝试检测iframe并等待内容加载
4. 截取全页面和iframe区域
5. 保存截图到本地 `.history` 目录
6. 发送截图到钉钉群2206
7. 发送汇总消息到钉钉群

## 注意事项

1. 确保系统已安装Chrome/Chromium和ChromeDriver
2. 确保网络可以访问目标URL和钉钉API
3. 脚本使用无头模式运行，不会打开浏览器窗口
4. 截图会自动保存到时间戳命名的目录中

## 故障排除

如果遇到问题，请检查：

1. ChromeDriver是否正确安装
2. 网络连接是否正常
3. 钉钉API密钥是否有效
4. 目标URL是否可以正常访问

## 与原脚本的区别

| 功能 | 原脚本 | 新脚本 |
|------|--------|--------|
| 相似度比对 | ✅ | ❌ |
| 钉钉群ID | 1183/1098 | 2206 |
| 配置文件 | config.test.yaml | config.new.yaml |
| 目标URL | 多个 | 单个新URL |
| 复杂度 | 高 | 低 |

新脚本保持了原有的核心功能，但简化了不必要的复杂性，专注于您的新需求。 